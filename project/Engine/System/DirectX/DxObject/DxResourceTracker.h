#pragma once

//-----------------------------------------------------------------------------------------
// include
//-----------------------------------------------------------------------------------------
//* DXOBJECT
#include "DxObjectCommon.h"
#include "DxDevice.h"
#include "DxCommandContext.h"

//* c++
#include <list>
#include <mutex>

////////////////////////////////////////////////////////////////////////////////////////////
// DXOBJECT
////////////////////////////////////////////////////////////////////////////////////////////
_DXOBJECT_NAMESPACE_BEGIN

////////////////////////////////////////////////////////////////////////////////////////////
// ResourceTracker class
////////////////////////////////////////////////////////////////////////////////////////////
class ResourceTracker {
public:

	////////////////////////////////////////////////////////////////////////////////////////////
	// using
	////////////////////////////////////////////////////////////////////////////////////////////

	using Collection = std::list<ResourceTracker>;
	using Iterator   = Collection::iterator;

public:

	//=========================================================================================
	// public methods
	//=========================================================================================

	_NODISCARD std::unique_lock<std::mutex> Transition(const CommandContext* context, D3D12_RESOURCE_STATES state);

private:

	//=========================================================================================
	// private variables
	//=========================================================================================

	ComPtr<ID3D12Resource> resource_;
	D3D12_RESOURCE_STATES state_;

	std::optional<Iterator> iterator_;
	std::mutex mutex_;

};

////////////////////////////////////////////////////////////////////////////////////////////
// ResourceTrackerCollection class
////////////////////////////////////////////////////////////////////////////////////////////
class ResourceTrackerCollection {
public:

private:
};

_DXOBJECT_NAMESPACE_END

